<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriHook - MEV Protection for Farmers</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.1/ethers.umd.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app" id="app">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">‚òï</span>
                <span class="logo-text">AgriHook</span>
                <span class="logo-tag">MEV Protection</span>
            </div>
            <div class="header-right">
                <div class="network-badge">
                    <span class="network-dot"></span>
                    <span>Flare Coston2</span>
                </div>
                <button class="btn-connect" id="connectBtn" onclick="connectWallet()">
                    <span id="connectText">Connect Wallet</span>
                </button>
            </div>
        </header>

        <!-- Main Grid -->
        <main class="main-grid">
            <!-- Left Column: Farmer View -->
            <div class="column farmer-column">
                <h2 class="column-title">üë®‚Äçüåæ Farmer View</h2>
                
                <!-- Wallet Card -->
                <div class="card">
                    <div class="card-label">Wallet Balance</div>
                    <div class="card-value large">
                        <span id="walletBalance">--</span>
                        <span class="unit">C2FLR</span>
                    </div>
                </div>

                <!-- FAsset Card -->
                <div class="card fasset-card">
                    <div class="card-header">
                        <span class="card-label">ü™ô FAsset Holdings</span>
                        <span class="badge badge-fasset">FBTC</span>
                    </div>
                    <div class="card-value">
                        <span id="fbtcBalance">--</span>
                        <span class="unit">FBTC</span>
                    </div>
                    <div class="fasset-info">
                        <span>‚âà $<span id="fbtcUsdValue">--</span> USD</span>
                    </div>
                    <div class="fasset-desc">FAsset Bitcoin - Trustless BTC on Flare</div>
                </div>

                <!-- Policy Card -->
                <div class="card">
                    <div class="card-label">Insurance Policy</div>
                    <div class="policy-status" id="policyStatusBadge">NO POLICY</div>
                    <div class="policy-details">
                        <div class="detail-row">
                            <span>Coverage</span>
                            <span id="coverageAmount">--</span>
                        </div>
                        <div class="detail-row">
                            <span>Location</span>
                            <span>Minas Gerais, Brazil</span>
                        </div>
                    </div>
                    <button class="btn-secondary" id="createPolicyBtn">Create Policy (1 C2FLR)</button>
                </div>

                <!-- Claim Card -->
                <div class="card claim-card" id="claimCard">
                    <div class="card-label">üéâ Payout Available</div>
                    <div class="card-value">
                        <span id="payoutAmount">2,500</span>
                        <span class="unit">C2FLR</span>
                    </div>
                    <button class="btn-primary btn-glow" id="claimBtn" disabled>Claim Payout</button>
                </div>
            </div>

            <!-- Right Column: Protocol War Room -->
            <div class="column protocol-column">
                <h2 class="column-title">üõ°Ô∏è Protocol War Room</h2>

                <!-- Weather Oracle Card -->
                <div class="card oracle-card" id="oracleCard">
                    <div class="card-header">
                        <span class="card-label">FDC Weather Oracle</span>
                        <span class="badge badge-live">LIVE</span>
                    </div>
                    <div class="oracle-status" id="weatherStatusBadge">NORMAL</div>
                    <div class="oracle-details">
                        <div class="detail-row">
                            <span>Base Price</span>
                            <span><span id="basePrice">--</span> FBTC</span>
                        </div>
                        <div class="detail-row">
                            <span>Oracle Price</span>
                            <span id="theoreticalPrice">--</span> FBTC</span>
                        </div>
                        <div class="detail-row">
                            <span>Price Gap</span>
                            <span id="priceGap" class="gap-value">0%</span>
                        </div>
                    </div>
                    
                    <!-- Drought Toggle -->
                    <div class="drought-control">
                        <span class="control-label">‚ö†Ô∏è SIMULATE DROUGHT</span>
                        <label class="toggle">
                            <input type="checkbox" id="droughtToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- FTSO Card -->
                <div class="card ftso-card">
                    <div class="card-header">
                        <span class="card-label">üì° FTSO Price Feed</span>
                        <span class="badge badge-ftso">LIVE</span>
                    </div>
                    <div class="ftso-price">
                        <span class="ftso-symbol">testBTC</span>
                        <span class="ftso-value">$<span id="ftsoPrice">--</span></span>
                    </div>
                    <div class="ftso-info">
                        Decentralized price oracle ‚Ä¢ Updated every 3 min
                    </div>
                    <button class="btn-small" id="updateFtsoBtn">‚ü≥ Update Price from FTSO</button>
                </div>

                <!-- Fee Card -->
                <div class="card fee-card">
                    <div class="card-label">Dynamic Swap Fee (Hook)</div>
                    <div class="fee-display" id="feeDisplay">
                        <span class="fee-value" id="currentFee">0.01</span>
                        <span class="fee-percent">%</span>
                    </div>
                    <div class="fee-bar">
                        <div class="fee-fill" id="feeFill" style="width: 0.1%"></div>
                    </div>
                    <div class="fee-labels">
                        <span>0.01% (Normal)</span>
                        <span>50% (Crisis)</span>
                    </div>
                </div>

                <!-- Bot Attack Card -->
                <div class="card bot-card">
                    <div class="card-header">
                        <span class="card-label">ü§ñ Arbitrage Defense</span>
                    </div>
                    <div class="treasury-display">
                        <span class="treasury-label">Treasury Balance</span>
                        <div class="treasury-value">
                            <span id="treasuryValue">0</span>
                            <span class="unit">C2FLR</span>
                        </div>
                    </div>
                    <button class="btn-danger" id="botAttackBtn">
                        <span class="bot-icon">ü§ñ</span>
                        Simulate Bot Attack
                    </button>
                </div>
            </div>
        </main>

        <!-- Terminal Log -->
        <div class="terminal">
            <div class="terminal-header">
                <span class="terminal-dot red"></span>
                <span class="terminal-dot yellow"></span>
                <span class="terminal-dot green"></span>
                <span class="terminal-title">System Log</span>
            </div>
            <div class="terminal-content" id="terminal">
                <div class="log-line">> AgriHook initialized. Waiting for wallet connection...</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-contracts">
                <span>Oracle: <code>0x223...3fd</code></span>
                <span>Hook: <code>0x0FA...C0</code></span>
                <span>Vault: <code>0x6c6...438</code></span>
                <span>FBTC: <code>0x8C6...F12</code></span>
            </div>
            <div class="footer-tech">
                <span class="tech-badge">FDC</span>
                <span class="tech-badge">FTSO</span>
                <span class="tech-badge">FAssets</span>
                <span class="tech-badge">Uniswap V4</span>
            </div>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <span id="loadingText">Processing...</span>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Confetti Canvas -->
    <canvas id="confetti"></canvas>

    <script src="app.js"></script>
</body>
</html>
